<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ui-lib - The Most Ergonomic Component Library Ever Built</title>
    
    <!-- Meta tags for sharing -->
    <meta name="description" content="Revolutionary SSR-first component library with function-style props, CSS-only format, and three-tier hybrid reactivity. Zero client dependencies.">
    <meta name="keywords" content="component library, SSR, TypeScript, Deno, HTMX, reactivity, web components">
    <meta name="author" content="ui-lib">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="ui-lib - The Most Ergonomic Component Library Ever Built">
    <meta property="og:description" content="Revolutionary SSR-first component library with function-style props, CSS-only format, and three-tier hybrid reactivity.">
    <meta property="og:url" content="https://ui-lib-demo.deno.dev">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ui-lib - The Most Ergonomic Component Library">
    <meta name="twitter:description" content="Zero client dependencies, function-style props, CSS-only format, hybrid reactivity.">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">

    <!-- Base CSS: Open Props Foundation -->
    <link rel="stylesheet" href="/assets/open-props/1.7.16/normalize.min.css">
    <link rel="stylesheet" href="/assets/open-props/1.7.16/open-props.min.css">
    <link rel="stylesheet" href="/assets/open-props/1.7.16/buttons.min.css">
    <link rel="stylesheet" href="/assets/open-props/1.7.16/fonts.min.css">
    <link rel="stylesheet" href="/assets/open-props/1.7.16/forms.min.css">
    
    <!-- Project Design System -->
    <link rel="stylesheet" href="/assets/tokens.css">
    <link rel="stylesheet" href="/assets/utilities.css">
    <link rel="stylesheet" href="/demo/styles.css">

    <!-- HTMX for dynamic interactions -->
    <script src="https://unpkg.com/htmx.org@2.0.6"></script>
    <script src="https://unpkg.com/htmx-ext-json-enc@2.0.1/json-enc.js"></script>

    <!-- Enhanced CSS Theme Variables -->
    <style>
      :root {
        /* Theme system */
        --demo-theme: light;
        --demo-mode: light;
        
        /* Dynamic theme colors */
        --theme-bg: var(--gray-0);
        --theme-text: var(--gray-9);
        --theme-accent: var(--indigo-6);
        --theme-border: var(--gray-3);
        
        /* Enhanced animation system */
        --demo-ease-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
        --demo-ease-smooth: cubic-bezier(0.4, 0, 0.2, 1);
        
        /* Responsive breakpoints */
        --demo-bp-sm: 640px;
        --demo-bp-md: 768px;
        --demo-bp-lg: 1024px;
        --demo-bp-xl: 1280px;
      }

      /* Dark theme support */
      [data-theme="dark"] {
        --theme-bg: var(--gray-9);
        --theme-text: var(--gray-1);
        --theme-accent: var(--indigo-4);
        --theme-border: var(--gray-7);
      }

      /* Base styling */
      body {
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", system-ui, sans-serif;
        background: var(--theme-bg);
        color: var(--theme-text);
        transition: background-color 0.3s var(--demo-ease-smooth), color 0.3s var(--demo-ease-smooth);
        line-height: 1.6;
      }

      /* Smooth scrolling */
      html {
        scroll-behavior: smooth;
      }

      /* Enhanced focus styles */
      :focus {
        outline: 2px solid var(--theme-accent);
        outline-offset: 2px;
        border-radius: var(--radius-2);
      }

      /* Loading states */
      .htmx-request {
        opacity: 0.7;
        transition: opacity 0.2s ease;
      }

      .htmx-request::after {
        content: " ‚è≥";
      }

      /* Selection styling */
      ::selection {
        background: var(--theme-accent);
        color: white;
      }

      /* Scrollbar styling */
      ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
      }

      ::-webkit-scrollbar-track {
        background: var(--gray-2);
      }

      ::-webkit-scrollbar-thumb {
        background: var(--gray-5);
        border-radius: var(--radius-2);
      }

      ::-webkit-scrollbar-thumb:hover {
        background: var(--gray-6);
      }

      /* Skip to main content for accessibility */
      .skip-to-main {
        position: absolute;
        top: -40px;
        left: 6px;
        background: var(--theme-accent);
        color: white;
        padding: 8px 16px;
        text-decoration: none;
        border-radius: var(--radius-2);
        z-index: 9999;
        transition: top 0.3s;
      }

      .skip-to-main:focus {
        top: 6px;
      }

      /* Print styles */
      @media print {
        body {
          background: white !important;
          color: black !important;
        }
        
        .demo-nav,
        button,
        .demo-animate-up,
        .demo-animate-left {
          display: none !important;
        }
      }
    </style>
  </head>
  
  <body hx-ext="json-enc" hx-encoding="json">
    <!-- Accessibility -->
    <a href="#main-content" class="skip-to-main">Skip to main content</a>

    <!-- Global State Manager -->
    <script>
      // Enhanced state manager with debugging and performance monitoring
      (function () {
        if (window.funcwcState) return;
        
        const startTime = performance.now();
        console.log('üèóÔ∏è Initializing ui-lib state manager...');
        
        window.funcwcState = {
          _state: new Map(),
          _subscribers: new Map(),
          _metrics: { publishes: 0, subscribes: 0, cleanups: 0 },
          
          publish: function (topic, data) {
            this._metrics.publishes++;
            this._state.set(topic, {
              data: data,
              timestamp: Date.now(),
            });
            
            const subs = this._subscribers.get(topic) || [];
            const alive = [];
            
            for (const sub of subs) {
              if (document.contains(sub.element)) {
                try {
                  sub.callback.call(sub.element, data);
                } catch (e) {
                  console.warn(`State callback error for topic "${topic}":`, e);
                }
                alive.push(sub);
              } else {
                this._metrics.cleanups++;
              }
            }
            
            this._subscribers.set(topic, alive);
            console.log(`üì° Published to "${topic}":`, data);
          },
          
          subscribe: function (topic, callback, element) {
            if (typeof topic !== "string" || typeof callback !== "function" || !(element instanceof Element)) {
              console.error('Invalid subscription parameters');
              return;
            }
            
            this._metrics.subscribes++;
            const subs = this._subscribers.get(topic) || [];
            subs.push({ callback, element });
            this._subscribers.set(topic, subs);
            
            // Immediate callback if state exists
            if (this._state.has(topic)) {
              try {
                callback.call(element, this._state.get(topic).data);
              } catch (e) {
                console.warn(`Initial state callback error for topic "${topic}":`, e);
              }
            }
            
            console.log(`üéØ Subscribed to "${topic}"`);
          },
          
          getState: function (topic) {
            const entry = this._state.get(topic);
            return entry ? entry.data : undefined;
          },
          
          clearTopic: function (topic) {
            this._state.delete(topic);
            this._subscribers.delete(topic);
            console.log(`üóëÔ∏è Cleared topic "${topic}"`);
          },
          
          getTopics: function () {
            return Array.from(this._state.keys());
          },
          
          getSubscriberCount: function (topic) {
            return (this._subscribers.get(topic) || []).length;
          },
          
          getMetrics: function () {
            return { ...this._metrics, initTime: performance.now() - startTime };
          }
        };
        
        console.log(`‚úÖ State manager ready in ${(performance.now() - startTime).toFixed(2)}ms`);
      })();

      // Global cart action helper
      window.uiLibCartAction = function (action, itemData) {
        const item = typeof itemData === 'string' ? JSON.parse(itemData) : itemData;
        console.log(`üõí Cart ${action}:`, item);
        
        const currentCart = window.funcwcState?.getState("cart") || { items: [], count: 0, total: 0 };
        let newItems = [...currentCart.items];

        switch (action) {
          case "add":
            const existing = newItems.findIndex(i => i.id === item.id);
            if (existing >= 0) {
              newItems[existing].quantity += item.quantity || 1;
            } else {
              newItems.push({ ...item, quantity: item.quantity || 1 });
            }
            break;
            
          case "remove":
            newItems = newItems.filter(i => i.id !== item.id);
            break;
            
          case "update":
            const updateIndex = newItems.findIndex(i => i.id === item.id);
            if (updateIndex >= 0) {
              newItems[updateIndex] = { ...newItems[updateIndex], ...item };
            }
            break;
            
          case "clear":
            newItems = [];
            break;
        }

        const cartState = {
          items: newItems,
          count: newItems.reduce((sum, item) => sum + item.quantity, 0),
          total: newItems.reduce((sum, item) => sum + (item.price * item.quantity), 0),
          isEmpty: newItems.length === 0,
          lastUpdated: Date.now()
        };

        window.funcwcState?.publish("cart", cartState);
        return cartState;
      };

      // Global theme management
      window.uiLibTheme = {
        set: function(theme) {
          document.documentElement.setAttribute('data-theme', theme);
          document.documentElement.style.setProperty('--demo-theme', theme);
          localStorage.setItem('ui-lib-theme', theme);
          console.log(`üé® Theme set to ${theme}`);
        },
        
        toggle: function() {
          const current = document.documentElement.getAttribute('data-theme') || 'light';
          const next = current === 'light' ? 'dark' : 'light';
          this.set(next);
          return next;
        },
        
        get: function() {
          return document.documentElement.getAttribute('data-theme') || 'light';
        },
        
        init: function() {
          const saved = localStorage.getItem('ui-lib-theme');
          const preferred = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
          this.set(saved || preferred);
          
          // Listen for system theme changes
          window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
            if (!localStorage.getItem('ui-lib-theme')) {
              this.set(e.matches ? 'dark' : 'light');
            }
          });
        }
      };

      // Initialize theme on load
      document.addEventListener('DOMContentLoaded', function() {
        window.uiLibTheme.init();
      });

      // Performance monitoring
      window.uiLibPerf = {
        marks: new Map(),
        
        mark: function(name) {
          this.marks.set(name, performance.now());
        },
        
        measure: function(name, startMark) {
          const start = this.marks.get(startMark);
          const end = performance.now();
          const duration = end - start;
          console.log(`‚è±Ô∏è ${name}: ${duration.toFixed(2)}ms`);
          return duration;
        },
        
        getMetrics: function() {
          return {
            stateManager: window.funcwcState?.getMetrics(),
            navigation: performance.getEntriesByType('navigation')[0],
            marks: Object.fromEntries(this.marks)
          };
        }
      };

      // Mark page load start
      window.uiLibPerf.mark('pageStart');
    </script>

    <!-- Navigation -->
    <nav class="demo-nav" role="navigation" aria-label="Demo navigation">
      <div class="demo-container">
        <ul class="demo-nav-list">
          <li><a href="#hero" class="demo-nav-item active">Home</a></li>
          <li><a href="#function-props" class="demo-nav-item">Function Props</a></li>
          <li><a href="#css-format" class="demo-nav-item">CSS Format</a></li>
          <li><a href="#reactivity" class="demo-nav-item">Reactivity</a></li>
          <li><a href="#unified-api" class="demo-nav-item">Unified API</a></li>
          <li><a href="#real-world" class="demo-nav-item">Examples</a></li>
          <li>
            <button 
              class="demo-nav-item" 
              onclick="window.uiLibTheme.toggle()"
              aria-label="Toggle theme"
              title="Toggle light/dark theme"
            >
              üåì
            </button>
          </li>
        </ul>
      </div>
    </nav>

    <!-- Main Content -->
    <main id="main-content">
      <!-- Hero Section -->
      <showcase-hero 
        title="ui-lib" 
        subtitle="The Most Ergonomic Component Library Ever Built"
        show-stats="true"
        show-features="true"
      />

      <!-- Main Content Container -->
      <div class="demo-container">
        
        <!-- Interactive Feature Preview -->
        <section class="demo-section demo-animate-up">
          <feature-preview 
            title="Revolutionary Component Development"
            show-code="true"
          />
        </section>

        <!-- Function-Style Props Showcase -->
        <showcase-function-props 
          title="‚ú® Function-Style Props Revolution"
          show-comparison="true"
        />
        
        <!-- Live function props demo -->
        <section class="demo-section demo-animate-left">
          <function-props-demo 
            title="Interactive Demo Component" 
            count="42" 
            enabled="true"
            items='["TypeScript", "Deno", "HTMX", "ui-lib"]'
            config='{"theme": "modern", "version": "2.0", "features": ["SSR", "Reactivity"]}'
          />
        </section>

        <section class="demo-section">
          <type-helpers-showcase />
        </section>

        <!-- CSS-Only Format Showcase -->
        <showcase-css-format 
          title="üé® CSS-Only Format Revolution"
          show-comparison="true"
          show-process="true"
        />

        <section class="demo-section demo-animate-up">
          <css-format-live-demo show-code="true" />
          <style-processing-visualizer />
        </section>

        <!-- Hybrid Reactivity System -->
        <showcase-reactivity 
          title="‚ö° Three-Tier Hybrid Reactivity"
          show-tier-comparison="true"
          show-live-demo="true"
        />

        <!-- Unified API System -->
        <showcase-unified-api 
          title="üîÑ Unified API System"
          show-comparison="true"
          show-workflow="true"
        />

        <section class="demo-section">
          <api-method-comparison />
        </section>

        <!-- Real-World Examples -->
        <real-world-examples 
          title="üèóÔ∏è Production-Ready Applications"
          show-stats="true"
        />

        <!-- E-commerce Demo -->
        <section class="demo-section">
          <ecommerce-demo 
            title="üõçÔ∏è ui-lib Store" 
            show-cart="true"
          />
        </section>

        <!-- Analytics Dashboard -->
        <section class="demo-section">
          <analytics-dashboard title="üìä Real-Time Analytics" />
        </section>

        <!-- Performance Metrics -->
        <section class="demo-section demo-animate-fade">
          <div class="demo-card">
            <h3 style="color: var(--theme-accent); margin-bottom: var(--size-4); text-align: center;">
              üìà Performance Metrics
            </h3>
            
            <div class="demo-grid demo-grid-4">
              <div style="text-align: center; padding: var(--size-3); background: var(--green-0); border: 1px solid var(--green-3); border-radius: var(--radius-3);">
                <div style="font-size: var(--font-size-3); font-weight: var(--font-weight-7); color: var(--green-7); margin-bottom: var(--size-1);">
                  0KB
                </div>
                <div style="font-size: var(--font-size-0); color: var(--green-6); text-transform: uppercase;">
                  Client JavaScript
                </div>
              </div>
              
              <div style="text-align: center; padding: var(--size-3); background: var(--blue-0); border: 1px solid var(--blue-3); border-radius: var(--radius-3);">
                <div style="font-size: var(--font-size-3); font-weight: var(--font-weight-7); color: var(--blue-7); margin-bottom: var(--size-1);">
                  100%
                </div>
                <div style="font-size: var(--font-size-0); color: var(--blue-6); text-transform: uppercase;">
                  Server-Side Rendered
                </div>
              </div>
              
              <div style="text-align: center; padding: var(--size-3); background: var(--purple-0); border: 1px solid var(--purple-3); border-radius: var(--radius-3);">
                <div style="font-size: var(--font-size-3); font-weight: var(--font-weight-7); color: var(--purple-7); margin-bottom: var(--size-1);">
                  ~2KB
                </div>
                <div style="font-size: var(--font-size-0); color: var(--purple-6); text-transform: uppercase;">
                  Reactive Features
                </div>
              </div>
              
              <div style="text-align: center; padding: var(--size-3); background: var(--orange-0); border: 1px solid var(--orange-3); border-radius: var(--radius-3);">
                <div style="font-size: var(--font-size-3); font-weight: var(--font-weight-7); color: var(--orange-7); margin-bottom: var(--size-1);">
                  3-Tier
                </div>
                <div style="font-size: var(--font-size-0); color: var(--orange-6); text-transform: uppercase;">
                  Reactivity System
                </div>
              </div>
            </div>
            
            <div style="text-align: center; margin-top: var(--size-4); padding: var(--size-3); background: var(--theme-accent); color: white; border-radius: var(--radius-3);">
              <strong>üéØ Built for Production:</strong> Type-safe, accessible, performant, and maintainable
            </div>
          </div>
        </section>

        <!-- Call to Action -->
        <section class="demo-section" style="text-align: center; padding: var(--size-8) var(--size-4);">
          <h2 style="font-size: var(--font-size-5); color: var(--theme-accent); margin-bottom: var(--size-4);">
            Ready to Build the Future?
          </h2>
          <p style="font-size: var(--font-size-2); color: var(--theme-text); margin-bottom: var(--size-6); max-width: 600px; margin-left: auto; margin-right: auto;">
            Join the revolution in component development. Zero client dependencies, maximum developer ergonomics.
          </p>
          
          <div style="display: flex; gap: var(--size-4); justify-content: center; flex-wrap: wrap;">
            <a 
              href="https://github.com/your-org/ui-lib" 
              class="demo-button"
              style="text-decoration: none; display: inline-block;"
              target="_blank"
              rel="noopener noreferrer"
            >
              ‚≠ê Star on GitHub
            </a>
            <a 
              href="/docs" 
              class="demo-button demo-button-secondary"
              style="text-decoration: none; display: inline-block;"
            >
              üìö Read Documentation
            </a>
            <button 
              class="demo-button demo-button-secondary"
              onclick="navigator.clipboard?.writeText('deno add ui-lib') && alert('Install command copied!')"
            >
              üì¶ Copy Install Command
            </button>
          </div>
        </section>
      </div>
    </main>

    <!-- Footer -->
    <footer style="background: var(--gray-1); padding: var(--size-6) 0; margin-top: var(--size-8); border-top: 1px solid var(--theme-border);">
      <div class="demo-container">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: var(--size-6); margin-bottom: var(--size-6);">
          <div>
            <h3 style="color: var(--theme-accent); margin-bottom: var(--size-3);">ui-lib</h3>
            <p style="color: var(--theme-text); font-size: var(--font-size-1); line-height: 1.6;">
              The most ergonomic component library ever built. SSR-first, zero client dependencies, 
              with revolutionary function-style props and three-tier reactivity.
            </p>
          </div>
          
          <div>
            <h4 style="color: var(--theme-text); margin-bottom: var(--size-3);">Features</h4>
            <ul style="list-style: none; padding: 0; margin: 0; color: var(--gray-7);">
              <li style="margin-bottom: var(--size-2);">‚ú® Function-Style Props</li>
              <li style="margin-bottom: var(--size-2);">üé® CSS-Only Format</li>
              <li style="margin-bottom: var(--size-2);">‚ö° Three-Tier Reactivity</li>
              <li style="margin-bottom: var(--size-2);">üîÑ Unified API System</li>
              <li style="margin-bottom: var(--size-2);">üöÄ Zero Client Dependencies</li>
            </ul>
          </div>
          
          <div>
            <h4 style="color: var(--theme-text); margin-bottom: var(--size-3);">Resources</h4>
            <ul style="list-style: none; padding: 0; margin: 0;">
              <li style="margin-bottom: var(--size-2);">
                <a href="/docs" style="color: var(--theme-accent); text-decoration: none;">Documentation</a>
              </li>
              <li style="margin-bottom: var(--size-2);">
                <a href="/examples" style="color: var(--theme-accent); text-decoration: none;">More Examples</a>
              </li>
              <li style="margin-bottom: var(--size-2);">
                <a href="https://github.com/your-org/ui-lib" style="color: var(--theme-accent); text-decoration: none;" target="_blank">GitHub</a>
              </li>
              <li style="margin-bottom: var(--size-2);">
                <a href="/api-reference" style="color: var(--theme-accent); text-decoration: none;">API Reference</a>
              </li>
            </ul>
          </div>
        </div>
        
        <div style="text-align: center; padding-top: var(--size-4); border-top: 1px solid var(--theme-border); color: var(--gray-6);">
          <p style="margin: 0;">
            Built with ‚ù§Ô∏è and ui-lib ‚Ä¢ <span id="perf-info"></span>
          </p>
        </div>
      </div>
    </footer>

    <!-- Global Cart Badge (floating) -->
    <cart-badge cart-id="demo" />

    <!-- Navigation Enhancement -->
    <script>
      // Enhanced navigation with smooth scrolling and active states
      document.addEventListener('DOMContentLoaded', function() {
        const navItems = document.querySelectorAll('.demo-nav-item[href^="#"]');
        const sections = document.querySelectorAll('section[id], showcase-hero, showcase-function-props, showcase-css-format, showcase-reactivity, showcase-unified-api, real-world-examples');
        
        // Smooth scroll with offset for fixed nav
        navItems.forEach(item => {
          item.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href').slice(1);
            const target = document.getElementById(targetId) || document.querySelector(`[id="${targetId}"]`);
            
            if (target) {
              const navHeight = document.querySelector('.demo-nav').offsetHeight;
              const targetPosition = target.offsetTop - navHeight - 20;
              
              window.scrollTo({
                top: targetPosition,
                behavior: 'smooth'
              });
              
              // Update active state
              navItems.forEach(nav => nav.classList.remove('active'));
              this.classList.add('active');
            }
          });
        });
        
        // Intersection observer for active states
        const observerOptions = {
          rootMargin: '-20% 0px -60% 0px',
          threshold: 0
        };
        
        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              const id = entry.target.id || entry.target.tagName.toLowerCase().replace('-', '');
              const navItem = document.querySelector(`[href="#${id}"]`);
              
              if (navItem) {
                navItems.forEach(nav => nav.classList.remove('active'));
                navItem.classList.add('active');
              }
            }
          });
        }, observerOptions);
        
        sections.forEach(section => observer.observe(section));
        
        // Performance info display
        window.addEventListener('load', function() {
          const perfInfo = document.getElementById('perf-info');
          if (perfInfo) {
            const loadTime = window.uiLibPerf.measure('pageLoad', 'pageStart');
            const metrics = window.uiLibPerf.getMetrics();
            perfInfo.textContent = `Page loaded in ${loadTime.toFixed(0)}ms`;
            
            // Show detailed metrics in console
            console.log('üìä ui-lib Demo Metrics:', metrics);
          }
        });
        
        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
          if (e.altKey) {
            switch (e.key) {
              case '1':
                e.preventDefault();
                document.querySelector('[href="#hero"]')?.click();
                break;
              case '2':
                e.preventDefault();
                document.querySelector('[href="#function-props"]')?.click();
                break;
              case '3':
                e.preventDefault();
                document.querySelector('[href="#css-format"]')?.click();
                break;
              case '4':
                e.preventDefault();
                document.querySelector('[href="#reactivity"]')?.click();
                break;
              case '5':
                e.preventDefault();
                document.querySelector('[href="#unified-api"]')?.click();
                break;
              case '6':
                e.preventDefault();
                document.querySelector('[href="#real-world"]')?.click();
                break;
              case 't':
                e.preventDefault();
                window.uiLibTheme.toggle();
                break;
            }
          }
        });
        
        console.log('üéπ Keyboard shortcuts: Alt+1-6 for sections, Alt+T for theme toggle');
      });
    </script>

    <!-- Analytics (placeholder) -->
    <script>
      // Placeholder for analytics
      if (typeof gtag !== 'undefined') {
        gtag('event', 'page_view', {
          page_title: 'ui-lib Demo',
          page_location: window.location.href
        });
      }
    </script>
  </body>
</html>